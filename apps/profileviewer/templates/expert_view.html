{% extends "frame.html" %}
{% block extra_header %}
  <script src="/static/bower_components/sticky-kit/jquery.sticky-kit.js" type="text/javascript" charset="utf-8"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC4oLS7DjhME0pLuTTauJw3rjs1_n4TuKM&sensor=false" type="text/javascript" charset="utf-8"></script>
  <script src="/static/bower_components/d3/d3.js" type="text/javascript" charset="utf-8"></script>
  <script src="/static/bower_components/crossfilter/crossfilter.js" type="text/javascript" charset="utf-8"></script>
  <script src="/static/bower_components/dcjs/dc.js" type="text/javascript" charset="utf-8"></script>
  <script src="/static/bower_components/gmaps/gmaps.js" type="text/javascript" charset="utf-8"></script>
  <script src="/static/js/profileviewer/expert_view.js" type="text/javascript" charset="utf-8"></script>

  <link rel="stylesheet" href="/static/bower_components/dcjs/dc.css" type="text/css" media="screen" title="no title" charset="utf-8">
  <script type="text/javascript" charset="utf-8">
    $(document).ready(function () {
      profileviewer_ns.initCharts("{{ screen_name | safe }}");
      <!--$("#pv-judgment-panel").stick_in_parent();-->
      
      {% for t in expertise %}
        (function(){
          var focus_name = JSON.parse("{{ t.focus_name_json | escapejs }}");
          var focus_id = JSON.parse("{{ t.focus_id_json | escapejs }}");
          {% if 'zcate' in t.topic_id %}
          $("#pv-topic-{{ t.topic_id }}").click(
            function(){
              profileviewer_ns.focusTopic(focus_id[0], 'z');
            });
          {% elif 'cate' in t.topic_id %}
          $("#pv-topic-{{ t.topic_id }}").click(
            function(){
              profileviewer_ns.focusTopic(focus_id[0], 'c');
            });
          $("#pv-topic-{{ t.topic_id }}-z").click(
            function(){
              profileviewer_ns.focusTopic(focus_id[1], 'z');
            });
          {% elif 'poi' in t.topic_id %}
          $("#pv-topic-{{ t.topic_id }}").click(
            function(){
              profileviewer_ns.focusTopic(focus_id[0], 'p');
            });
          $("#pv-topic-{{ t.topic_id }}-c").click(
            function(){
              profileviewer_ns.focusTopic(focus_id[1], 'c');
            });
          $("#pv-topic-{{ t.topic_id }}-z").click(
            function(){
              profileviewer_ns.focusTopic(focus_id[2], 'z');
            });
          {% endif %}
        })();
      {% endfor %}
    });
  </script>
  <style type="text/css" media="screen">
    a:hover {
      cursor: pointer;
      text-decoration: none;
    }
    .btn.active, .btn:active {
      background-color: #428bca;
      color: white;
    }
  </style>
{% endblock %}
{% block content %}
<div id="pv-judgment-panel" class="panel panel-default" style="z-index: 100">
  <!--<div class="panel-heading">Judgments</div>-->
  <div class="panel-body">
    <form action="/judge_expert" method="post" accept-charset="utf-8" role="form">
      {% csrf_token %}
      <div class="list-group">
        {% for t in expertise %}
        <div class="list-group-item">
          <div class="row">
            <div class="col-lg-9">
              Relevance to
              <a id="pv-topic-{{ t.topic_id }}">
                <b>{{ t.topic }}</b>
                <span class="glyphicon glyphicon-search"></span>
              </a>
              in
              <b>{{ t.region }}</b>
              {% if 'zcate' not in t.topic_id %} <!-- show zcate if it is a poi or category topic -->
                (
                {% if 'poi' in t.topic_id %} <!-- show category if it is a poi topic -->
                  <a id="pv-topic-{{ t.topic_id }}-c">
                    <b>{{ t.focus_name | slice:"1:" | first }}</b>
                    <span class="glyphicon glyphicon-search"></span>
                  </a>,
                {% endif %}
                <a id="pv-topic-{{ t.topic_id }}-z">
                  <b>{{ t.focus_name | last }}</b>
                  <span class="glyphicon glyphicon-search"></span>
                </a>
                )
              {% endif %}
            </div>
            <div class="col-lg-3">
              <div class="btn-group btn-group-xs" data-toggle="buttons">
                <label class="btn btn-default" for="">
                  <input type="radio" name="pv-judgements-{{ t.topic_id  }}"> Not Relevant
                </label>
                <label class="btn btn-default" for="">
                  <input type="radio" name="pv-judgements-{{ t.topic_id  }}"> Relevant
                </label>
                <label class="btn btn-default" for="">
                  <input type="radio" name="pv-judgements-{{ t.topic_id  }}"> High Relevant
                </label>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
      <div class="row">
        <div class="col-lg-10"> </div>
        <div class="col-lg-2">
          <button type="submit" class="btn btn-primary">Submit &amp; Continue</button>
        </div>
      </div>
    </form>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <div class="row">
      <div class="col-lg-11">
        Statistics for <a href="https://twitter.com/{{screen_name | safe}}">@{{screen_name | safe}}</a>
      </div>
      <div class="col-lg-1">
        <button type="button" class="btn btn-default btn-xs" onClick="dc.filterAll();dc.redrawAll();"><span class="glyphicon glyphicon-repeat"></span> Reset</button>
      </div>
    </div>
  </div>
  <div class="panel-body">
    <div class="panel panel-default">
      <div class="panel-body">
        <div id="pv-charts" class="row">
          <div class="col-lg-3">
            <div id="chart-zcate-pie" > </div>
          </div>
          <div class="col-lg-3">
            <div id="chart-cate-pie"> </div>
          </div>
          <div class="col-lg-3">
            <div id="chart-poi-pie"> </div>
          </div>
          <div class="col-lg-3">
            <div id="chart-region-pie"> </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12">
            <div id="chart-timeline"> </div>
          </div>
        </div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-body">
        <div id="map-canvas" style="height: 500px;width: 100%"></div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
